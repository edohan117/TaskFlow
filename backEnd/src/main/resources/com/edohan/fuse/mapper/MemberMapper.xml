<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edohan.fuse.mapper.MemberMapper">

    <!-- Member list -->
    <select id="memberList" resultType="java.util.Map">
        SELECT USER_ID,
                USER_NM,
                PHONE,
                EMAIL,
                ROLE,
                CREATEDATE,
                UPDATEDATE
        FROM TB_MEMBER
    </select>
    
    <!-- 회원 등록 -->
    <insert id="insertMember" parameterType="java.util.Map">
        INSERT INTO 
        TB_MEMBER 
            (USER_ID,
            USER_NM,
            PASSWORD,
            PHONE,
            EMAIL,
            BIRTH,
            ROLE,
            SOCIAL_LINKS,
            POST_CODE,
            ROAD_ADDRESS,
            JIBUN_ADDRESS,
            DETAIL_ADDRESS,
            EXTRA_ADDRESS,
            CREATEDATE,
            UPDATEDATE)
        VALUES 
            (#{userId},
            #{userNm},
            #{password},
            #{phone},
            #{email},
            #{birth},
            'USER',
            #{socialLinks},
            #{postCode},
            #{roadAddress},
            #{jibunAddress},
            #{detailAddress},
            #{extraAddress},
            NOW(),
            NOW())
    </insert>

    <!-- 사용자 비밀번호 조회 -->
    <select id="getPassword" parameterType="java.lang.String" resultType="java.lang.String">
        SELECT PASSWORD
        FROM TB_MEMBER
        WHERE USER_ID = #{userId}
    </select>

    <!-- 사용자 이름 조회 -->
    <select id="getUserNm" parameterType="java.lang.String" resultType="java.lang.String">
        SELECT USER_NM
        FROM TB_MEMBER
        WHERE USER_ID = #{userId}
    </select>

    <!-- 사용자 권한 조회 -->
    <select id="getRole" parameterType="java.lang.String" resultType="java.lang.String">
        SELECT ROLE
        FROM TB_MEMBER
        WHERE USER_ID = #{userId}
    </select>
    
    <select id="getProfile" parameterType="java.lang.String" resultType="java.util.Map">
        SELECT 
            USER_ID,
            USER_NM,
            PASSWORD,
            PHONE,
            EMAIL,
            BIRTH,
            ROLE,
            PROFILE_PICTURE,
            BIO,
            SOCIAL_LINKS,
            POST_CODE,
            ROAD_ADDRESS,
            JIBUN_ADDRESS,
            DETAIL_ADDRESS,
            EXTRA_ADDRESS,
            CREATEDATE,
            UPDATEDATE
        FROM 
            TB_MEMBER
        WHERE 
            USER_ID = #{userId}
    </select>

    <select id="checkIdExists" parameterType="map" resultType="Integer">
        SELECT COUNT(*)
        FROM TB_MEMBER
        WHERE USER_ID = #{id}
    </select>
</mapper>
